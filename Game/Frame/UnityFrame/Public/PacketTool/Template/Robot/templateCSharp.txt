using UnityEngine;
using System.Collections;
using ProtobufPacket;
using Network;

enum MessageID :short
    {
$beginrepeat$
        PACKETID_$name$ = $id$,
$endrepeat$
		PACKETID_MAX,
    }

    public class PacketDispatcher
    {
        public static void ReceivePacket(Robot packetReceiver, int messageID, System.IO.Stream packetData)
        {
            switch(messageID)
            {
$beginrepeatgc$
                case $id$: $name$_Handler.ReceivePacket(packetReceiver, $name$.Deserialize(packetData)); break;
$endrepeat$
$beginrepeatxx$
                case $id$: $name$_Handler.ReceivePacket(packetReceiver, $name$.Deserialize(packetData)); break;
$endrepeat$
            }
        }
    }

    public abstract class ProtoPacket
    {
        public abstract short GetMessageID();
        public abstract byte[] GetPacketArray();
        public void SendPacket(NetworkLogic sender)
        {
            sender.SendPacket(this);
        }
    }
$beginrepeatcg$
    public class $name$_PAK : ProtoPacket
    {
        private $name$ m_packet = new $name$();
        public $name$ data { get {return m_packet;} }

        public override short GetMessageID()
        {
            return (short)MessageID.PACKETID_$name$;
        }

        public override byte[] GetPacketArray()
        {
            return $name$.SerializeToBytes(m_packet);
        }

    }
$endrepeat$
$beginrepeatxx$
    public class $name$_PAK : ProtoPacket
    {
        private $name$ m_packet = new $name$();
        public $name$ data { get {return m_packet;} }

        public override short GetMessageID()
        {
            return (short)MessageID.PACKETID_$name$;
        }

        public override byte[] GetPacketArray()
        {
            return $name$.SerializeToBytes(m_packet);
        }

    }
$endrepeat$